import graph;
settings.tex="xelatex";
texpreamble("\usepackage{xeCJK}");
texpreamble("\usepackage{bm}");
texpreamble("\setCJKmainfont{SimSun}");
size(8cm,8cm,IgnoreAspect);

real[][] datas8t001 = 
{
{0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5},
{1.500519, 1.773968, 1.925280, 2.009407, 2.056553, 2.083345, 2.098934, 2.108357, 2.114387, 2.118550, 2.121685, 2.124257, 2.126518, 2.128610, 2.130609, 2.132557, 2.134479, 2.136386, 2.138287, 2.140184, 2.142081, 2.143977, 2.145875, 2.147774, 2.149674, 2.151576, 2.153479, 2.155384, 2.157291, 2.159199, 2.161109, 2.163021, 2.164934, 2.166849, 2.168766, 2.170685, 2.172605, 2.174527, 2.176450, 2.178376, 2.180303, 2.182231, 2.184162, 2.186094, 2.188028, 2.189963, 2.191901, 2.193840, 2.195780, 2.197723},
{3.098, 3.731, 2.120, 2.028, 0.959, 0.425, 2.677, 2.336, 0.498, 1.793, 1.832, 0.568, 1.101, 1.745, 4.091, 2.827, 0.734, 0.142, 1.871, 2.165, 2.226, 2.445, 1.360, 1.258, 4.171, 0.305, 1.085, 2.063, 2.924, 1.649, 0.916, 3.381, 1.459, 0.182, 2.520, 0.943, 1.530, 0.614, 1.918, 1.135, 2.578, 1.566, 2.122, 0.213, 3.113, 0.483, 2.590, 2.297, 2.790, 2.150},
{1.476e-03, 1.981e-03, 2.273e-03, 2.456e-03, 2.574e-03, 2.650e-03, 2.699e-03, 2.732e-03, 2.754e-03, 2.769e-03, 2.780e-03, 2.789e-03, 2.796e-03, 2.802e-03, 2.808e-03, 2.813e-03, 2.818e-03, 2.823e-03, 2.828e-03, 2.833e-03, 2.838e-03, 2.843e-03, 2.848e-03, 2.853e-03, 2.858e-03, 2.863e-03, 2.868e-03, 2.873e-03, 2.878e-03, 2.883e-03, 2.888e-03, 2.892e-03, 2.897e-03, 2.902e-03, 2.907e-03, 2.912e-03, 2.917e-03, 2.922e-03, 2.927e-03, 2.932e-03, 2.937e-03, 2.942e-03, 2.947e-03, 2.951e-03, 2.956e-03, 2.961e-03, 2.966e-03, 2.971e-03, 2.976e-03, 2.981e-03},
};

real[][] datas8t002 = 
{
{0.02, 0.04, 0.06, 0.08, 0.1, 0.12, 0.14, 0.16, 0.18, 0.2, 0.22, 0.24, 0.26, 0.28, 0.3, 0.32, 0.34, 0.36, 0.38, 0.4, 0.42, 0.44, 0.46, 0.48, 0.5},
{1.689726, 1.951923, 2.053791, 2.094797, 2.112697, 2.121826, 2.127630, 2.132174, 2.136245, 2.140140, 2.143972, 2.147785, 2.151594, 2.155406, 2.159224, 2.163048, 2.166878, 2.170715, 2.174559, 2.178410, 2.182267, 2.186132, 2.190003, 2.193881, 2.197766},
{1.064, 1.515, 0.544, 1.294, 0.863, 0.615, 0.105, 0.782, 1.642, 0.898, 0.880, 1.410, 0.933, 1.367, 0.447, 0.997, 0.399, 0.828, 0.519, 0.237, 0.629, 0.716, 0.213, 0.724, 1.462},
{4.560e-02, 2.622e-02, 1.157e-02, 3.717e-03, 1.227e-06, 1.641e-03, 2.340e-03, 2.633e-03, 2.757e-03, 2.813e-03, 2.841e-03, 2.858e-03, 2.872e-03, 2.883e-03, 2.894e-03, 2.905e-03, 2.916e-03, 2.926e-03, 2.937e-03, 2.947e-03, 2.958e-03, 2.969e-03, 2.979e-03, 2.990e-03, 3.001e-03},
};

real[][] datas8t005 = 
{
{0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5},
{1.896167, 2.078930, 2.122449, 2.138616, 2.149435, 2.159237, 2.168873, 2.178510, 2.188182, 2.197895},
{0.114, 0.464, 0.298, 0.452, 0.787, 0.397, 0.598, 0.389, 0.452, 0.165},
{7.561e-02, 1.598e-02, 1.033e-03, 2.098e-03, 2.747e-03, 2.900e-03, 2.956e-03, 2.994e-03, 3.027e-03, 3.060e-03},
};

real[][] datas8t01 = 
{
{0.1, 0.2, 0.3, 0.4, 0.5},
{2.001733, 2.127287, 2.158004, 2.178529, 2.198094},
{0.049, 0.233, 0.075, 0.200, 0.010},
{5.252e-02, 3.210e-03, 2.328e-03, 3.002e-03, 3.151e-03},
};


scale(Linear,Log);
draw(graph(datas8t001[0],datas8t001[3]),legend="$\Delta t$=0.01s");
draw(graph(datas8t002[0],datas8t002[3]),legend="$\Delta t$=0.02s", dashed);
draw(graph(datas8t005[0],datas8t005[3]),legend="$\Delta t$=0.05s", Dotted);
draw(graph(datas8t01 [0],datas8t01 [3]),legend="$\Delta t$=0.10s", dashdotted);
xaxis("模型时间/s", BottomTop,LeftTicks);
yaxis("总功率相对误差",LeftRight,RightTicks);
add(legend(perline=2, linelength=20),point(N),10N);