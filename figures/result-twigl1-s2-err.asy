import graph;
settings.tex="xelatex";
texpreamble("\usepackage{xeCJK}");
texpreamble("\usepackage{bm}");
texpreamble("\setCJKmainfont{SimSun}");
size(8cm,8cm,IgnoreAspect);

real[][] datas2t001 = 
{
{0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5},
{1.497149, 1.768639, 1.918725, 2.002088, 2.048761, 2.075258, 2.090662, 2.099966, 2.105916, 2.110023, 2.113117, 2.115655, 2.117887, 2.119952, 2.121926, 2.123851, 2.125749, 2.127634, 2.129511, 2.131386, 2.133260, 2.135134, 2.137009, 2.138885, 2.140762, 2.142641, 2.144521, 2.146404, 2.148287, 2.150173, 2.152060, 2.153949, 2.155839, 2.157731, 2.159625, 2.161520, 2.163417, 2.165316, 2.167216, 2.169118, 2.171022, 2.172927, 2.174834, 2.176743, 2.178653, 2.180565, 2.182479, 2.184394, 2.186311, 2.188230},
{9.039, 9.039, 9.228, 6.774, 6.739, 7.607, 8.787, 8.513, 7.814, 6.616, 9.179, 8.041, 5.437, 6.604, 7.893, 7.628, 9.033, 8.612, 6.654, 9.222, 5.090, 7.127, 4.768, 7.774, 7.454, 6.965, 9.289, 6.009, 6.749, 8.032, 5.548, 5.383, 7.819, 7.452, 6.770, 6.315, 6.102, 7.092, 6.825, 5.351, 8.943, 6.502, 8.426, 6.705, 7.294, 7.661, 6.965, 7.307, 6.337, 7.415},
{7.741e-04, 1.028e-03, 1.139e-03, 1.195e-03, 1.225e-03, 1.242e-03, 1.252e-03, 1.259e-03, 1.263e-03, 1.267e-03, 1.270e-03, 1.272e-03, 1.274e-03, 1.277e-03, 1.279e-03, 1.281e-03, 1.283e-03, 1.285e-03, 1.287e-03, 1.289e-03, 1.291e-03, 1.293e-03, 1.295e-03, 1.297e-03, 1.299e-03, 1.302e-03, 1.304e-03, 1.306e-03, 1.308e-03, 1.310e-03, 1.312e-03, 1.314e-03, 1.316e-03, 1.318e-03, 1.320e-03, 1.322e-03, 1.324e-03, 1.326e-03, 1.328e-03, 1.330e-03, 1.333e-03, 1.335e-03, 1.337e-03, 1.339e-03, 1.341e-03, 1.343e-03, 1.345e-03, 1.347e-03, 1.349e-03, 1.351e-03},
};

real[][] datas2t002 = 
{
{0.02, 0.04, 0.06, 0.08, 0.1, 0.12, 0.14, 0.16, 0.18, 0.2, 0.22, 0.24, 0.26, 0.28, 0.3, 0.32, 0.34, 0.36, 0.38, 0.4, 0.42, 0.44, 0.46, 0.48, 0.5},
{1.684931, 1.945057, 2.045983, 2.086555, 2.104243, 2.113258, 2.118987, 2.123474, 2.127495, 2.131342, 2.135129, 2.138895, 2.142659, 2.146425, 2.150197, 2.153975, 2.157759, 2.161550, 2.165347, 2.169151, 2.172962, 2.176780, 2.180604, 2.184435, 2.188272},
{4.373, 3.262, 4.446, 3.628, 4.121, 3.631, 4.074, 4.620, 3.109, 4.572, 4.208, 4.569, 4.005, 4.021, 2.925, 3.577, 4.429, 3.926, 3.627, 3.187, 4.119, 3.086, 3.441, 3.724, 4.628},
{4.831e-02, 2.965e-02, 1.533e-02, 7.637e-03, 4.002e-03, 2.403e-03, 1.731e-03, 1.458e-03, 1.350e-03, 1.310e-03, 1.296e-03, 1.292e-03, 1.293e-03, 1.296e-03, 1.299e-03, 1.302e-03, 1.305e-03, 1.308e-03, 1.312e-03, 1.315e-03, 1.318e-03, 1.322e-03, 1.325e-03, 1.329e-03, 1.332e-03},
};

real[][] datas2t005 = 
{
{0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5},
{1.889653, 2.070811, 2.113867, 2.129839, 2.140527, 2.150210, 2.159729, 2.169250, 2.178804, 2.188399},
{1.778, 1.728, 2.046, 1.320, 1.605, 2.095, 1.466, 1.186, 1.323, 1.348},
{7.879e-02, 1.983e-02, 5.072e-03, 2.014e-03, 1.409e-03, 1.293e-03, 1.272e-03, 1.270e-03, 1.272e-03, 1.274e-03},
};

real[][] datas2t01 = 
{
{0.1, 0.2, 0.3, 0.4, 0.5},
{1.994261, 2.118631, 2.148992, 2.169267, 2.188595},
{0.755, 1.075, 0.874, 0.846, 0.890},
{5.606e-02, 7.266e-03, 1.858e-03, 1.262e-03, 1.185e-03},
};


scale(Linear,Log);
draw(graph(datas2t001[0],datas2t001[3]),legend="$\Delta t$=0.01s");
draw(graph(datas2t002[0],datas2t002[3]),legend="$\Delta t$=0.02s", dashed);
draw(graph(datas2t005[0],datas2t005[3]),legend="$\Delta t$=0.05s", Dotted);
draw(graph(datas2t01[0], datas2t01 [3]),legend="$\Delta t$=0.10s", dashdotted);
ylimits(8e-4,1e-1);
xaxis("模型时间/s", BottomTop,LeftTicks);
yaxis("总功率相对误差",LeftRight,RightTicks);
add(legend(perline=2, linelength=20),point(N),10N);