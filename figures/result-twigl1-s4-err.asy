import graph;
settings.tex="xelatex";
texpreamble("\usepackage{xeCJK}");
texpreamble("\usepackage{bm}");
texpreamble("\setCJKmainfont{SimSun}");
size(8cm,8cm,IgnoreAspect);

// res_size4_timestep0.01.h5
real[][] datas1t001 = {
{0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5},
{1.519606, 1.780569, 1.913901, 1.982478, 2.018158, 2.037128, 2.047609, 2.053777, 2.057756, 2.060623, 2.062926, 2.064943, 2.066816, 2.068616, 2.070379, 2.072125, 2.073863, 2.075597, 2.077330, 2.079063, 2.080797, 2.082532, 2.084268, 2.086006, 2.087745, 2.089486, 2.091228, 2.092971, 2.094716, 2.096463, 2.098211, 2.099960, 2.101711, 2.103463, 2.105216, 2.106971, 2.108728, 2.110486, 2.112246, 2.114007, 2.115769, 2.117533, 2.119298, 2.121065, 2.122833, 2.124603, 2.126375, 2.128147, 2.129922, 2.131697},
{3.431, 3.389, 3.294, 3.311, 2.969, 2.898, 2.689, 2.974, 2.793, 2.763, 2.599, 2.765, 2.678, 2.646, 2.712, 2.659, 2.664, 2.663, 2.602, 2.665, 2.680, 2.617, 2.697, 2.689, 2.676, 2.610, 2.701, 2.691, 2.627, 2.683, 2.660, 2.714, 2.631, 2.722, 2.679, 2.648, 2.598, 2.690, 2.657, 2.604, 2.665, 2.651, 2.682, 2.616, 2.664, 2.687, 2.611, 2.655, 2.695, 2.657},
{5.116e-04, 4.137e-04, 2.446e-04, 1.036e-04, 3.705e-06, 6.181e-05, 1.029e-04, 1.278e-04, 1.427e-04, 1.514e-04, 1.566e-04, 1.596e-04, 1.615e-04, 1.627e-04, 1.635e-04, 1.641e-04, 1.647e-04, 1.651e-04, 1.655e-04, 1.659e-04, 1.663e-04, 1.667e-04, 1.670e-04, 1.674e-04, 1.678e-04, 1.682e-04, 1.685e-04, 1.689e-04, 1.693e-04, 1.696e-04, 1.700e-04, 1.704e-04, 1.708e-04, 1.711e-04, 1.715e-04, 1.719e-04, 1.722e-04, 1.726e-04, 1.730e-04, 1.734e-04, 1.737e-04, 1.741e-04, 1.745e-04, 1.748e-04, 1.752e-04, 1.756e-04, 1.760e-04, 1.763e-04, 1.767e-04, 1.771e-04},
};

// res_size4_timestep0.02.h5
real[][] datas1t002 = {
{0.02, 0.04, 0.06, 0.08, 0.1, 0.12, 0.14, 0.16, 0.18, 0.2, 0.22, 0.24, 0.26, 0.28, 0.3, 0.32, 0.34, 0.36, 0.38, 0.4, 0.42, 0.44, 0.46, 0.48, 0.5},
{1.695052, 1.931340, 2.014028, 2.044447, 2.057073, 2.063643, 2.068155, 2.071970, 2.075551, 2.079057, 2.082541, 2.086021, 2.089504, 2.092991, 2.096484, 2.099983, 2.103488, 2.106998, 2.110514, 2.114036, 2.117564, 2.121098, 2.124637, 2.128183, 2.131734},
{1.732, 1.681, 1.636, 1.519, 1.415, 1.396, 1.378, 1.397, 1.361, 1.452, 1.319, 1.314, 1.318, 1.303, 1.324, 1.316, 1.294, 1.316, 1.321, 1.317, 1.284, 1.319, 1.352, 1.287, 1.317},
{4.842e-02, 2.590e-02, 1.128e-02, 4.416e-03, 1.572e-03, 4.704e-04, 6.020e-05, 8.914e-05, 1.432e-04, 1.631e-04, 1.709e-04, 1.746e-04, 1.768e-04, 1.785e-04, 1.800e-04, 1.815e-04, 1.829e-04, 1.844e-04, 1.858e-04, 1.873e-04, 1.887e-04, 1.901e-04, 1.916e-04, 1.930e-04, 1.945e-04},
};

// res_size4_timestep0.05.h5
real[][] datas1t005 = {
{0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5},
{1.875776, 2.031466, 2.065264, 2.078232, 2.087666, 2.096524, 2.105314, 2.114124, 2.122966, 2.131846},
{0.690, 0.640, 0.593, 0.576, 0.552, 0.559, 0.564, 0.576, 0.570, 0.564},
{7.055e-02, 1.400e-02, 2.308e-03, 2.337e-04, 1.296e-04, 1.990e-04, 2.181e-04, 2.287e-04, 2.378e-04, 2.467e-04},
};

// res_size4_timestep0.1.h5
real[][] datas1t01 = {
{0.1, 0.2, 0.3, 0.4, 0.5},
{1.964833, 2.070114, 2.095810, 2.114193, 2.132025},
{0.359, 0.301, 0.283, 0.286, 0.288},
{4.634e-02, 4.139e-03, 1.416e-04, 2.614e-04, 3.307e-04},
};


scale(Linear,Log);
draw(graph(datas1t001[0],datas1t001[3]),legend="$\Delta t$=0.01s");
draw(graph(datas1t002[0],datas1t002[3]),legend="$\Delta t$=0.02s", dashed);
draw(graph(datas1t005[0],datas1t005[3]),legend="$\Delta t$=0.05s", Dotted);
draw(graph(datas1t01 [0],datas1t01 [3]),legend="$\Delta t$=0.10s", dashdotted);
ylimits(3e-6, 1e-1);
xaxis("模型时间/s", BottomTop,LeftTicks);
yaxis("总功率相对误差",LeftRight,RightTicks);
add(legend(perline=2, linelength=20),point(N),10N);