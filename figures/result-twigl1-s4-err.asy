import graph;
settings.tex="xelatex";
texpreamble("\usepackage{xeCJK}");
texpreamble("\usepackage{bm}");
texpreamble("\setCJKmainfont{SimSun}");
size(8cm,8cm,IgnoreAspect);

real[][] datas4t001 = 
{
{0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5},
{1.495242, 1.765623, 1.915087, 1.998099, 2.044573, 2.070955, 2.086289, 2.095550, 2.101471, 2.105557, 2.108634, 2.111157, 2.113377, 2.115430, 2.117392, 2.119306, 2.121193, 2.123066, 2.124932, 2.126795, 2.128658, 2.130520, 2.132384, 2.134248, 2.136114, 2.137982, 2.139851, 2.141722, 2.143594, 2.145468, 2.147344, 2.149221, 2.151100, 2.152980, 2.154862, 2.156746, 2.158632, 2.160519, 2.162407, 2.164298, 2.166190, 2.168083, 2.169979, 2.171876, 2.173774, 2.175675, 2.177577, 2.179480, 2.181386, 2.183293},
{4.597, 3.410, 4.703, 1.901, 3.088, 5.479, 2.128, 2.911, 3.601, 4.296, 3.331, 3.482, 3.648, 4.148, 6.187, 3.756, 3.392, 4.544, 3.040, 2.139, 3.027, 3.404, 1.828, 2.185, 3.159, 3.510, 2.412, 4.026, 3.233, 6.045, 2.533, 3.350, 3.114, 3.455, 3.172, 4.387, 5.126, 4.457, 3.834, 2.609, 3.752, 3.289, 4.185, 3.809, 3.663, 2.217, 3.894, 3.380, 2.704, 1.977},
{2.047e-03, 2.732e-03, 3.033e-03, 3.185e-03, 3.267e-03, 3.313e-03, 3.341e-03, 3.359e-03, 3.371e-03, 3.381e-03, 3.388e-03, 3.395e-03, 3.401e-03, 3.407e-03, 3.413e-03, 3.418e-03, 3.424e-03, 3.429e-03, 3.435e-03, 3.440e-03, 3.446e-03, 3.451e-03, 3.457e-03, 3.462e-03, 3.468e-03, 3.473e-03, 3.479e-03, 3.484e-03, 3.490e-03, 3.495e-03, 3.500e-03, 3.506e-03, 3.511e-03, 3.517e-03, 3.522e-03, 3.528e-03, 3.533e-03, 3.539e-03, 3.544e-03, 3.550e-03, 3.555e-03, 3.561e-03, 3.566e-03, 3.572e-03, 3.577e-03, 3.583e-03, 3.588e-03, 3.594e-03, 3.599e-03, 3.605e-03},
};

real[][] datas4t002 = 
{
{0.02, 0.04, 0.06, 0.08, 0.1, 0.12, 0.14, 0.16, 0.18, 0.2, 0.22, 0.24, 0.26, 0.28, 0.3, 0.32, 0.34, 0.36, 0.38, 0.4, 0.42, 0.44, 0.46, 0.48, 0.5},
{1.682252, 1.941303, 2.041802, 2.082196, 2.099802, 2.108771, 2.114469, 2.118931, 2.122927, 2.126752, 2.130515, 2.134259, 2.138000, 2.141743, 2.145492, 2.149247, 2.153008, 2.156776, 2.160550, 2.164331, 2.168118, 2.171912, 2.175713, 2.179520, 2.183334},
{2.782, 1.113, 2.614, 1.990, 2.722, 1.968, 2.010, 1.086, 1.687, 1.073, 1.996, 2.204, 1.503, 1.503, 1.128, 1.069, 1.391, 1.915, 1.420, 1.820, 1.592, 1.201, 0.868, 1.752, 1.619},
{4.982e-02, 3.152e-02, 1.734e-02, 9.710e-03, 6.105e-03, 4.521e-03, 3.860e-03, 3.595e-03, 3.494e-03, 3.461e-03, 3.454e-03, 3.457e-03, 3.465e-03, 3.474e-03, 3.484e-03, 3.494e-03, 3.504e-03, 3.514e-03, 3.524e-03, 3.535e-03, 3.545e-03, 3.555e-03, 3.565e-03, 3.575e-03, 3.585e-03},
};

real[][] datas4t005 = 
{
{0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5},
{1.886120, 2.066510, 2.109367, 2.125255, 2.135880, 2.145504, 2.154966, 2.164428, 2.173924, 2.183460},
{0.529, 0.724, 0.488, 0.344, 0.345, 0.398, 1.191, 0.633, 0.471, 0.453},
{8.051e-02, 2.186e-02, 7.190e-03, 4.162e-03, 3.577e-03, 3.478e-03, 3.475e-03, 3.490e-03, 3.509e-03, 3.528e-03},
};

real[][] datas4t01 = 
{
{0.1, 0.2, 0.3, 0.4, 0.5},
{1.990276, 2.114093, 2.144291, 2.164444, 2.183653},
{0.360, 0.456, 0.346, 0.299, 0.276},
{5.795e-02, 9.392e-03, 4.042e-03, 3.482e-03, 3.440e-03},
};


scale(Linear,Log);
draw(graph(datas4t001[0],datas4t001[3]),legend="$\Delta t$=0.01s");
draw(graph(datas4t002[0],datas4t002[3]),legend="$\Delta t$=0.02s", dashed);
draw(graph(datas4t005[0],datas4t005[3]),legend="$\Delta t$=0.05s", Dotted);
draw(graph(datas4t01 [0],datas4t01 [3]),legend="$\Delta t$=0.10s", dashdotted);
ylimits(1e-3, 1e-1, Crop);
xaxis("模型时间/s", BottomTop,LeftTicks);
yaxis("总功率相对误差",LeftRight,RightTicks);
add(legend(perline=2, linelength=20),point(N),10N);