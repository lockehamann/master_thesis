
\chapter{结论与展望}

\section{结论}

本文主要研究了GPU加速在反应堆物理确定论计算中的应用。
首先介绍了目前GPU通用计算和科学计算的发展情况，
并以CUDA为例介绍了GPU编程的主要思路和编程模型。
此外还介绍了现代和Krylov子空间类线性方程求解算法
和它们在GPU上实现的工作。
对于稀疏矩阵在GPU上的存储格式也进行了介绍。

在上面的基础上，本文以三维扩散临界/时空动力学算法为例
进行了确定论方法的GPU并行化研究，
编写了使用GPU进行加速的\ProgramName 程序，
该程序对于静态IAEA PWR三维基准题、动态TWIGL二维基准题、
无热工反馈的动态LMW三维基准题进行了验证，
结果和同类程序符合得很好。
并对于三维IAEA基准题1cm网格下相对Citation程序
获得了最高272倍的加速效果，验证了GPU加速对于反应堆
物理确定论计算的重要意义。
对于时空动力学程序，\ProgramName 程序实现了154880个网格0.5s情况下
实时模拟，让个人电脑甚至高性能笔记本进行较大规模的实时动力学模拟成为可能。

此外本文还探讨了系数矩阵格式、迭代算法对扩散程序求解速度的影响，
指出DIA和ELL较为适合扩散程序的GPU并行化。
在迭代算法上，逐群求解的CG算法最适合三维扩散临界计算的GPU并行化。
对于动力学计算，BiCGStab方法可以进一步减少迭代次数，
较为适合动力学问题的GPU并行求解。

\section{展望}

目前GPU编程技术中CUDA使用的最为广泛，技术上也最为成熟，
在NVidia公司的大力推动下，CUDA的更新也十分迅速。
但CUDA编程相比传统CPU程序的编写要复杂的多，
不光需要了解GPU运算单元、存储体系的结构，
还需要自行管理显存和内存间的数据交换，
这都使得GPU并行程序的编写较为困难，
刚涉足于此的科技工作者上手难度较大。
此外CUDA技术只能在NVidia公司生产的显卡上使用，
对于AMD公司的独立显卡或是Intel公司的集成显卡都不支持。

可喜的是，近些年来除CUDA以外的其他技术也在蓬勃发展，
如可以跨硬件平台的OpenCL，C++ AMP等，
还有更容易使用的OpenACC等技术先后涌现。
虽然到目前为止，这些新技术的基础设施如编译器等还不太成熟，
生成的程序运行效率上可能还达不到CUDA的程序，
但随着相关技术的不断成熟，用户群的不断扩大，
这些新的技术将让GPU并行程序的开发工作量显著降低。

对于反应堆物理专业的科研工作者来说，
虽然目前支持OpenACC技术的编译器还很少，效果可能还不尽人意，
但随着计算机科学界在这方面研究的不断深入，编译器优化水平的不断提高，
OpenACC这样的指导性GPU并行化方式会更适合。
因为OpenACC抽象程度较高，可以脱离具体GPU参数进行开发，
可以显著降低相关程序的维护工作量，更适合非计算机专业的科学计算工作者。
